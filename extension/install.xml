<modification>
    <name>Show All Products On One Page By Henry</name>
	<code>Show All Products On One Page By Henry</code>
    <version>1.0.0</version>
    <author>ct47_henry@yahoo.com.hk</author>   
	<file path="admin/controller/catalog/category.php">
        <operation error="skip">
			<search><![CDATA[public function index() {]]></search>
            <add position="replace">
			<![CDATA[
			public function index() {
					$query = $this->db->query("SELECT * FROM " . DB_PREFIX . "category
                        WHERE category_id = '-1'");
					if ($query->num_rows) {
					}else{
                        $sql = "INSERT INTO ".DB_PREFIX."category (`category_id`, `image`, `parent_id`, `top`, `column`, 
						`sort_order`, `status`, `date_added`, `date_modified`) VALUES ('-1', '', '0', '1', '1', '0', '0', '".date('Y-m-d H:i:s')."', '".date('Y-m-d H:i:s')."')";
						$query = $this->db->query( $sql );
					}	
					
					$query = $this->db->query("SELECT * FROM " . DB_PREFIX . "category_path
                        WHERE category_id = '-1'");
						if ($query->num_rows) {
					}else{
                        $sql = "INSERT INTO ".DB_PREFIX."category_path (`category_id`, `path_id`, `level`) VALUES ('-1', '-1', '0')";
						$query = $this->db->query( $sql );
					}
					
					$query = $this->db->query("SELECT * FROM " . DB_PREFIX . "category_description
                        WHERE category_id = '-1'");
						if ($query->num_rows) {
					}else{
					$languages = $this->db->query("SELECT * FROM " . DB_PREFIX . "language");
					foreach ($languages->rows as $language) {
                        $sql = "INSERT INTO ".DB_PREFIX."category_description (`category_id`, `language_id`, `name`, `description`, `meta_title`,
						`meta_description`, `meta_keyword`) VALUES ('-1', '".$language['language_id']."', 'All', '', 'All', '', '')";
						$query = $this->db->query( $sql );
						}
					}
            ]]>
			</add>
        </operation>
    </file>
    <file path="catalog/controller/product/category.php">
        <operation>
            <search>
			<![CDATA[
				$data['heading_title'] = $category_info['name'];
            ]]>
			</search>
            <add position="replace">
			<![CDATA[
				$data['heading_title'] = $category_info['name'];
				
                if($category_id==-1)
					 $category_id=0;
            ]]>
			</add>
        </operation>
		<operation>
			<search>
				<![CDATA[
					foreach ($results as $result) {
				]]>
			</search>
            <add position="replace">
				<![CDATA[
				]]>
			</add>
        </operation>
		<operation>
			<search>
				<![CDATA[
					$results = $this->model_catalog_category->getCategories($category_id);
				]]>
			</search>
            <add position="replace">
				<![CDATA[
				$results = $this->model_catalog_category->getCategories($category_id);
				
				foreach ($results as $result) {
					if ($result['category_id']==-1)
				continue;
				]]>
			</add>
        </operation>
		<operation>
			<search>
				<![CDATA[
					$results = $this->model_catalog_product->getProducts($filter_data);
				]]>
			</search>
            <add position="replace">
				<![CDATA[
				$results = $this->model_catalog_product->getProducts($filter_data);
				
				foreach ($results as $result) {
				]]>
			</add>
        </operation>
    </file>
</modification>